<!DOCTYPE html>
<html lang="ko">
    <head>
        <title>Practice</title>
        <script>
        // 비동기 작업을 처리할 함수 선언
        async function fetchDataFromServer(url) {
            try {
                // 비동기 작업을 수행하고 결과를 반환하는 Promise를 반환
                const response = await fetch(url); // await 키워드는 비동기 함수 내에서만 사용 가능하며, 해당 작업이 완료될 때까지 기다림
                
                if (!response.ok) {
                    throw new Error('서버 응답이 정상적이지 않습니다.'); // 오류가 발생할 경우 에러를 던짐
                }

                // JSON 데이터를 파싱하여 반환하는 Promise를 반환
                const data = await response.json(); // await 키워드를 사용하여 비동기 작업의 결과를 변수에 할당
                return data; // 비동기 작업의 결과를 반환 (함수가 Promise를 반환하므로, 외부에서는 .then()을 이용해 결과를 받을 수 있음)
            } 
            catch (error) {
                // 오류 처리
                throw error; // 오류를 다시 던져서 상위 호출자에게 알림
                console.error('데이터를 불러오는 중 오류가 발생했습니다.', error);
            }
        }

        // 비동기 함수 호출
        async function getDataFromServer() {
            const apiUrl = 'https://github.com/minyore'; // 가져올 데이터가 있는 서버의 API URL

            try {
                console.log('데이터를 서버에서 가져오는 중...');
                const result = await fetchDataFromServer(apiUrl); // 비동기 함수 호출 시 await 키워드를 사용하여 비동기 작업이 완료될 때까지 기다림
                console.log('데이터를 성공적으로 가져왔습니다:', result);
                return result; // 함수의 반환 값 (비동기 작업의 결과)을 반환 (함수가 Promise를 반환하므로, 외부에서는 .then()을 이용해 결과를 받을 수 있음)
            } 
            catch (error) {
                console.error('데이터를 가져오는 중에 오류가 발생했습니다:', error);
                throw error; // 오류를 다시 던져서 상위 호출자에게 알림
            }
        }

        // getDataFromServer 함수 호출
        getDataFromServer()
            .then((result) => {
                console.log('비동기 함수의 결과를 사용하는 작업:', result);
            })
            .catch((error) => {
                console.error('비동기 함수에서 발생한 오류 처리:', error);
            });
        </script>
    </head>
    <body>
    </body>
</html>